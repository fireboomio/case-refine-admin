import{r as t,aa as C,a9 as l,j as c,a as r}from"./index.64257940.js";import"./iconUtil.71342ca5.js";import{S as D}from"./index.21d0aee3.js";import{c as L}from"./clsx.m.70024c70.js";import{a as N}from"./prismaRelation.c3fdd38c.js";import{s as d}from"./index.module.e663a310.js";import"./Portal.bf2e5144.js";import"./type.4482a080.js";import"./context.4fcda71f.js";import"./_baseIsEqual.ae1f3f6e.js";import"./omit.173224d8.js";import"./pickAttrs.91b30b21.js";import"./Overflow.ff04d686.js";import"./statusUtils.e7207d24.js";import"./SearchOutlined.d2d234c2.js";import"./get.ab779695.js";import"./isSymbol.d728fe31.js";import"./prisma-ast.esm.01fc1dd4.js";function P(h){const[u,S]=t.exports.useState([]),[a,p]=t.exports.useState(),[o,f]=t.exports.useState(),[g,x]=t.exports.useState([]),[y,q]=t.exports.useState(""),[n,w]=t.exports.useState();t.exports.useEffect(()=>{b()},[]),t.exports.useEffect(()=>{v()},[a]);async function v(){var s;if(!a)return;const e=C.loading("\u6B63\u5728\u52A0\u8F7D\u6A21\u578B\u5217\u8868");try{const i=await l.get(`/prisma/nativeSDL/${a}`,{timeout:15e3});q(i);const m=await l.get(`/prisma/dmf/${a}`,{timeout:15e3});x(m.models||[]),f((s=m.models)==null?void 0:s[0]),w(N(m.schemaContent))}catch(i){console.error(i)}e()}t.exports.useEffect(()=>{!o||h.onSelectedModelChange(o,u.find(e=>e.id===a),g,n==null?void 0:n[o.name],y)},[o]);const b=async()=>{var s;const e=await l.get("/dataSource?datasourceType=1");S(e),e.find(i=>i.id===a)||p((s=e==null?void 0:e[0])==null?void 0:s.id)};return c("div",{className:"common-form "+d.sider,children:[c("div",{className:"flex w-full items-center",children:[r(D,{value:a,onChange:e=>{p(e)},className:"flex-1",options:u.map(e=>{let s="/assets/icon/db-other.svg";switch(e.sourceType){case 1:s={mysql:"/assets/icon/mysql.svg",pgsql:"/assets/icon/pg.svg",graphql:"/assets/icon/graphql.svg",mongodb:"/assets/icon/mongodb.svg",rest:"/assets/icon/rest.svg",sqlite:"/assets/icon/sqlite.svg"}[String(e.config.dbType).toLowerCase()]||s;break;case 2:s="/assets/icon/rest.svg";break;case 3:s="/assets/icon/graphql.svg";break}return{name:e.name,label:c("div",{className:"flex items-center",children:[r("img",{className:"mr-1 w-3 h-3",alt:e.name,src:s}),e.name]}),value:e.id}})}),r("div",{className:"ml-1 w-28px h-28px bg-[#f7f7f7] flex items-center justify-center cursor-pointer",onClick:v,children:r("img",{width:18,height:18,src:"/assets/refresh.svg",alt:"\u5237\u65B0"})})]}),r("div",{className:"py-5px overflow-y-auto pa",children:g.map(e=>c("div",{className:L({[d.siderItem]:!0,[d.siderItemActive]:(o==null?void 0:o.name)===e.name}),onClick:()=>f(e),children:[r("img",{className:"mr-3",src:"/assets/model.svg",alt:"\u5237\u65B0"}),e.name]},e.name))})]})}export{P as default};
