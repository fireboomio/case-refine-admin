import{o as N,p as C,q as k,r as U}from"./_baseIsEqual.ae1f3f6e.js";import{c as H,d as K}from"./isArrayLikeObject.9676d780.js";import{r as j,a9 as F}from"./index.64257940.js";function R(){}var W=R,y=N,M=W,x=C,G=1/0,B=y&&1/x(new y([,-0]))[1]==G?function(e){return new y(e)}:M,V=B,z=k,Y=H,$=K,J=U,Z=V,Q=C,X=200;function ee(e,t,n){var r=-1,i=Y,o=e.length,a=!0,s=[],u=s;if(n)a=!1,i=$;else if(o>=X){var d=t?null:Z(e);if(d)return Q(d);a=!1,i=J,u=new z}else u=t?[]:s;e:for(;++r<o;){var c=e[r],l=t?t(c):c;if(c=n||c!==0?c:0,a&&l===l){for(var E=u.length;E--;)if(u[E]===l)continue e;t&&u.push(l),s.push(c)}else i(u,l,n)||(u!==s&&u.push(l),s.push(c))}return s}var ce=ee,I=["angular-cli","create-react-app","html","javascript","node","polymer","typescript","vue"],T={clickToLoad:function(e){return f("ctl",e)},devToolsHeight:function(e){return P("devtoolsheight",e)},forceEmbedLayout:function(e){return f("embed",e)},hideDevTools:function(e){return f("hidedevtools",e)},hideExplorer:function(e){return f("hideExplorer",e)},hideNavigation:function(e){return f("hideNavigation",e)},showSidebar:function(e){return function(t,n){return typeof n=="boolean"?"showSidebar="+(n?"1":"0"):""}(0,e)},openFile:function(e){return function(t,n){return(Array.isArray(n)?n:[n]).filter(function(r){return typeof r=="string"&&r.trim()!==""}).map(function(r){return"file="+encodeURIComponent(r.trim())})}(0,e).join("&")},terminalHeight:function(e){return P("terminalHeight",e)},theme:function(e){return O("theme",["light","dark"],e)},view:function(e){return O("view",["preview","editor"],e)}};function D(e){e===void 0&&(e={});var t=Object.entries(e).map(function(n){var r=n[0],i=n[1];return i!=null&&T.hasOwnProperty(r)?T[r](i):""}).filter(Boolean);return t.length?"?"+t.join("&"):""}function f(e,t){return t===!0?e+"=1":""}function P(e,t){return typeof t=="number"&&t>=0&&t<=100?e+"="+Math.round(t):""}function O(e,t,n){return typeof n=="string"&&t.includes(n)?e+"="+n:""}function A(){return Math.random().toString(36).slice(2,6)+Math.random().toString(36).slice(2,6)}function g(e,t){return""+L(t)+e+D(t)}function _(e,t){var n={forceEmbedLayout:!0};return t&&typeof t=="object"&&Object.assign(n,t),""+L(n)+e+D(n)}function L(e){return e===void 0&&(e={}),typeof e.origin=="string"?e.origin:"https://stackblitz.com"}function w(e,t,n){if(!t||!e||!e.parentNode)throw new Error("Invalid Element");e.id&&(t.id=e.id),e.className&&(t.className=e.className),function(r,i){i&&typeof i=="object"&&(Object.hasOwnProperty.call(i,"height")&&(r.height=""+i.height),Object.hasOwnProperty.call(i,"width")&&(r.width=""+i.width)),r.height||(r.height="300"),r.width||r.setAttribute("style","width:100%;")}(t,n),e.parentNode.replaceChild(t,e)}function b(e){if(typeof e=="string"){var t=document.getElementById(e);if(!t)throw new Error("Could not find element with id '"+e+"'");return t}if(e instanceof HTMLElement)return e;throw new Error("Invalid element: "+e)}function S(e){return e&&e.newWindow===!1?"_self":"_blank"}function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}var te=function(){function e(n){this.port=void 0,this.pending={},this.port=n,this.port.onmessage=this.messageListener.bind(this)}var t=e.prototype;return t.request=function(n){var r=this,i=n.type,o=n.payload,a=A();return new Promise(function(s,u){r.pending[a]={resolve:s,reject:u},r.port.postMessage({type:i,payload:m({},o,{__reqid:a})})})},t.messageListener=function(n){var r;if(typeof((r=n.data.payload)==null?void 0:r.__reqid)=="string"){var i=n.data,o=i.type,a=i.payload,s=a.__reqid,u=a.__error;this.pending[s]&&(a.__success?this.pending[s].resolve(function(d){var c=m({},d);return delete c.__reqid,delete c.__success,delete c.__error,Object.keys(c).length?c:null}(a)):this.pending[s].reject(u?o+": "+u:o),delete this.pending[s])}},e}(),ne=function(){function e(n,r){var i=this;this._rdc=void 0,this.editor={openFile:function(o){return i._rdc.request({type:"SDK_OPEN_FILE",payload:{path:o}})},setCurrentFile:function(o){return i._rdc.request({type:"SDK_SET_CURRENT_FILE",payload:{path:o}})},setTheme:function(o){return i._rdc.request({type:"SDK_SET_UI_THEME",payload:{theme:o}})},setView:function(o){return i._rdc.request({type:"SDK_SET_UI_VIEW",payload:{view:o}})},showSidebar:function(o){return o===void 0&&(o=!0),i._rdc.request({type:"SDK_TOGGLE_SIDEBAR",payload:{visible:o}})}},this.preview={origin:"",getUrl:function(){return i._rdc.request({type:"SDK_GET_PREVIEW_URL",payload:{}}).then(function(o){var a;return(a=o==null?void 0:o.url)!=null?a:null})},setUrl:function(o){if(o===void 0&&(o="/"),typeof o!="string"||!o.startsWith("/"))throw new Error("Invalid argument: expected a path starting with '/', got '"+o+"'");return i._rdc.request({type:"SDK_SET_PREVIEW_URL",payload:{path:o}})}},this._rdc=new te(n),Object.defineProperty(this.preview,"origin",{value:typeof r.previewOrigin=="string"?r.previewOrigin:null,writable:!1})}var t=e.prototype;return t.applyFsDiff=function(n){var r=function(i){return i!==null&&typeof i=="object"};if(!r(n)||!r(n.create))throw new Error("Invalid diff object: expected diff.create to be an object.");if(!Array.isArray(n.destroy))throw new Error("Invalid diff object: expected diff.create to be an array.");return this._rdc.request({type:"SDK_APPLY_FS_DIFF",payload:n})},t.getDependencies=function(){return this._rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})},t.getFsSnapshot=function(){return this._rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})},e}(),v=[],re=function(e){var t=this;this.element=void 0,this.id=void 0,this.pending=void 0,this.vm=void 0,this.id=A(),this.element=e,this.pending=new Promise(function(n,r){var i=function(d){var c=d.data;(c==null?void 0:c.action)==="SDK_INIT_SUCCESS"&&c.id===t.id&&(t.vm=new ne(d.ports[0],c.payload),n(t.vm),a())},o=function(){var d;(d=t.element.contentWindow)==null||d.postMessage({action:"SDK_INIT",id:t.id},"*")};function a(){window.clearInterval(u),window.removeEventListener("message",i)}window.addEventListener("message",i),o();var s=0,u=window.setInterval(function(){if(t.vm)a();else{if(s>=20)return a(),r("Timeout: Unable to establish a connection with the StackBlitz VM"),void v.forEach(function(d,c){d.id===t.id&&v.splice(c,1)});s++,o()}},500)}),v.push(this)};function p(e,t){var n=document.createElement("input");return n.type="hidden",n.name=e,n.value=t,n}function q(e){if(!I.includes(e.template)){var t=I.map(function(i){return"'"+i+"'"}).join(", ");console.warn("Unsupported project.template: must be one of "+t)}var n=e.template==="node",r=document.createElement("form");return r.method="POST",r.setAttribute("style","display:none!important;"),r.appendChild(p("project[title]",e.title)),r.appendChild(p("project[description]",e.description)),r.appendChild(p("project[template]",e.template)),e.dependencies&&(n?console.warn("Invalid project.dependencies: dependencies must be provided as a 'package.json' file when using the 'node' template."):r.appendChild(p("project[dependencies]",JSON.stringify(e.dependencies)))),e.settings&&r.appendChild(p("project[settings]",JSON.stringify(e.settings))),Object.keys(e.files).forEach(function(i){typeof e.files[i]=="string"&&r.appendChild(p("project[files]["+i+"]",e.files[i]))}),r}function h(e){var t,n,r,i;return e!=null&&e.contentWindow?(i=(n=e)instanceof Element?"element":"id",(t=(r=v.find(function(o){return o[i]===n}))!=null?r:null)!=null?t:new re(e)).pending:Promise.reject("Provided element is not an iframe.")}var ie={connect:h,embedGithubProject:function(e,t,n){var r=b(e),i=document.createElement("iframe");return i.src=_("/github/"+t,n),w(r,i,n),h(i)},embedProject:function(e,t,n){var r,i=b(e),o=function(s,u){var d=q(s);return d.action=_("/run",u),d.id="sb","<html><head><title></title></head><body>"+d.outerHTML+"<script>document.getElementById('"+d.id+"').submit();<\/script></body></html>"}(t,n),a=document.createElement("iframe");return w(i,a,n),(r=a.contentDocument)==null||r.write(o),h(a)},embedProjectId:function(e,t,n){var r=b(e),i=document.createElement("iframe");return i.src=_("/edit/"+t,n),w(r,i,n),h(i)},openGithubProject:function(e,t){var n=g("/github/"+e,t),r=S(t);window.open(n,r)},openProject:function(e,t){(function(n,r){var i=q(n);i.action=g("/run",r),i.target=S(r),document.body.appendChild(i),i.submit(),document.body.removeChild(i)})(e,t)},openProjectId:function(e,t){var n=g("/edit/"+e,t),r=S(t);window.open(n,r)}};function ue(){const[e,t]=j.exports.useState(!1);return{openHookServer:j.exports.useCallback(r=>{t(!0),F.get("/hook/dependFiles").then(i=>{const{dependFiles:o}=i;ie.openProject({template:"node",title:"Fireboom hooks online server",description:r?Array.isArray(r)?r.join(`
`):r:"",files:{...Object.keys(o).reduce((a,s)=>(a[s]=o[s],a),{})}},{newWindow:!0,openFile:r}),t(!1)}).catch(()=>t(!1))},[]),loading:e}}export{ce as _,ue as u};
